import "vista.art"!

ARTURO [
    Title: "Validation Demo"
    Logo: "arturo-vista.png"
    Width: 920
    Height: 620
]

status: "Fill the form and click Validate"

view .file:"ui.html" [
    raw {<style>
    .vform {display:grid; gap:10px; max-width:560px;}
    .vrow {display:grid; gap:4px;}
    .verr {color:#b00020; font-size:13px; min-height:18px;}
    .vok {color:#0f5132; font-weight:600;}
    .vbad {color:#b00020; font-weight:600;}
    </style>
    <script>
    function byId(id){ return document.getElementById(id); }
    function setErr(id,msg){ var el=byId(id); if(el){ el.textContent=msg||''; } }
    function setStatus(msg,ok){
      var s=byId('form-status');
      if(!s) return;
      s.textContent=msg;
      s.className = ok ? 'vok' : 'vbad';
    }
    function validateDemoForm(){
      var name=(byId('name')?.value||'').trim();
      var email=(byId('email')?.value||'').trim();
      var ageRaw=(byId('age')?.value||'').trim();
      var pwd=(byId('password')?.value||'');
      var confirm=(byId('confirm')?.value||'');

      setErr('err-name','');
      setErr('err-email','');
      setErr('err-age','');
      setErr('err-password','');
      setErr('err-confirm','');

      var ok=true;

      if(!name){ setErr('err-name','Name is required.'); ok=false; }

      var emailRx=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if(!email){ setErr('err-email','Email is required.'); ok=false; }
      else if(!emailRx.test(email)){ setErr('err-email','Email format is invalid.'); ok=false; }

      var age=Number(ageRaw);
      if(!ageRaw){ setErr('err-age','Age is required.'); ok=false; }
      else if(!Number.isFinite(age) || age < 18 || age > 120){ setErr('err-age','Age must be between 18 and 120.'); ok=false; }

      if(pwd.length < 8){ setErr('err-password','Password must be at least 8 characters.'); ok=false; }

      if(confirm !== pwd){ setErr('err-confirm','Passwords do not match.'); ok=false; }

      if(ok){ setStatus('Validation passed.', true); }
      else { setStatus('Validation failed. Please fix highlighted fields.', false); }
    }

    function clearDemoForm(){
      ['name','email','age','password','confirm'].forEach(function(id){ var el=byId(id); if(el) el.value=''; });
      ['err-name','err-email','err-age','err-password','err-confirm'].forEach(function(id){ setErr(id,''); });
      setStatus('Form cleared.', true);
    }
    </script>}

    title "Form Validation Demo"
    text "Basic client-side validation using current Vista runtime."

    raw {<div class="vform">
      <div class="vrow">
        <label for="name">Name (required)</label>
        <input id="name" type="text" placeholder="Enter your name" />
        <div id="err-name" class="verr"></div>
      </div>

      <div class="vrow">
        <label for="email">Email (required)</label>
        <input id="email" type="email" placeholder="you@example.com" />
        <div id="err-email" class="verr"></div>
      </div>

      <div class="vrow">
        <label for="age">Age (18-120)</label>
        <input id="age" type="number" placeholder="Enter age" />
        <div id="err-age" class="verr"></div>
      </div>

      <div class="vrow">
        <label for="password">Password (min 8 chars)</label>
        <input id="password" type="password" placeholder="Create password" />
        <div id="err-password" class="verr"></div>
      </div>

      <div class="vrow">
        <label for="confirm">Confirm Password</label>
        <input id="confirm" type="password" placeholder="Confirm password" />
        <div id="err-confirm" class="verr"></div>
      </div>

      <div style="display:flex; gap:8px;">
        <button type="button" onclick="validateDemoForm()">Validate</button>
        <button type="button" onclick="clearDemoForm()">Clear</button>
      </div>

      <div id="form-status"></div>
    </div>}
]
